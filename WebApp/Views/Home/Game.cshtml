@{
    ViewBag.Title = "Play Blessed vs. Cursed";
}
<h2>@ViewBag.Title</h2>

<style>
    #selectRole { margin-bottom: 10px; }
    #sendMessage { margin-bottom: 10px; }
    #sendMessage #message { width: 400px; }
    #gameLog { border: 1px solid black; overflow:scroll; height: 500px; margin-bottom: 10px; }
</style>

<div id="selectRole">
    <select>
        <option value="0">Player 1 - Blessed</option>
        <option value="1">Player 2 - Cursed</option>
    </select>
    <input type="button" id="setPlayer" value="Select Deck" />
    <input type="button" id="startNewGame" value="Start Game" />

    <input type="text" id="message" />
    <input type="button" id="sendmessage" value="Send" />
    <input type="hidden" id="playerId" />
</div>

<div id="gameLog">
    <ul id="discussion"></ul>
</div>

<!--Script references. -->
<!--Reference the jQuery library. -->
<script src="/Scripts/jquery-1.10.2.min.js"></script>
<!--Reference the SignalR library. -->
<script src="/Scripts/jquery.signalR-2.2.0.min.js"></script>
<!--Reference the autogenerated SignalR hub script. -->
<script src="/signalr/hubs"></script>
<!--Add script to update the page and send messages.-->
<script type="text/javascript">
    $(function () {
        var chat = $.connection.chatHub;

        chat.client.broadcastMessage = function (name, data) {
            var obj = jQuery.parseJSON(data);
            $.each(obj, function (key, val) {

                $.each(val, function (key2, val2) {

                    var encodedName = $('<div />').text(name).html();
                    var encodedMsg = $('<div />').text(key + ' :: ' + key2 + ' : ' + val2).html();
                    $('#discussion').append('<li><strong>' + encodedName
                        + '</strong>:&nbsp;&nbsp;' + encodedMsg + '</li>');

                });

            });
        };

        $.connection.hub.start().done(function () {
            $('#sendmessage').click(function () {
                chat.server.send($('#message').val());
                $('#message').val('').focus();
            });

            
            $('#setPlayer').click(function () {
                $('#playerId').val($('#selectRole option:selected').val());
                chat.server.setPlayer($('#playerId').val());
            });

            $('#startNewGame').click(function () {
                chat.server.startNew();
            });
        });
    });
</script>
